<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Gaussian Process · Surrogates.jl</title><meta name="title" content="Gaussian Process · Surrogates.jl"/><meta property="og:title" content="Gaussian Process · Surrogates.jl"/><meta property="twitter:title" content="Gaussian Process · Surrogates.jl"/><meta name="description" content="Documentation for Surrogates.jl."/><meta property="og:description" content="Documentation for Surrogates.jl."/><meta property="twitter:description" content="Documentation for Surrogates.jl."/><meta property="og:url" content="https://docs.sciml.ai/Surrogates/stable/abstractgps/"/><meta property="twitter:url" content="https://docs.sciml.ai/Surrogates/stable/abstractgps/"/><link rel="canonical" href="https://docs.sciml.ai/Surrogates/stable/abstractgps/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Surrogates.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Surrogates.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Surrogates.jl: Surrogate models and optimization for scientific machine learning</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/">Basics</a></li><li><a class="tocitem" href="../radials/">Radials</a></li><li><a class="tocitem" href="../kriging/">Kriging</a></li><li class="is-active"><a class="tocitem" href>Gaussian Process</a><ul class="internal"><li><a class="tocitem" href="#1D-Example"><span>1D Example</span></a></li><li><a class="tocitem" href="#Optimization-Example"><span>Optimization Example</span></a></li><li><a class="tocitem" href="#ND-Example"><span>ND Example</span></a></li></ul></li><li><a class="tocitem" href="../lobachevsky/">Lobachevsky</a></li><li><a class="tocitem" href="../LinearSurrogate/">Linear</a></li><li><a class="tocitem" href="../InverseDistance/">InverseDistance</a></li><li><a class="tocitem" href="../randomforest/">RandomForest</a></li><li><a class="tocitem" href="../secondorderpoly/">SecondOrderPolynomial</a></li><li><a class="tocitem" href="../neural/">NeuralSurrogate</a></li><li><a class="tocitem" href="../wendland/">Wendland</a></li><li><a class="tocitem" href="../polychaos/">Polynomial Chaos</a></li><li><a class="tocitem" href="../variablefidelity/">Variable Fidelity</a></li><li><a class="tocitem" href="../gek/">Gradient Enhanced Kriging</a></li><li><a class="tocitem" href="../gekpls/">GEKPLS</a></li><li><a class="tocitem" href="../moe/">MOE</a></li><li><a class="tocitem" href="../parallel/">Parallel Optimization</a></li></ul></li><li><span class="tocitem">User guide</span><ul><li><a class="tocitem" href="../samples/">Samples</a></li><li><a class="tocitem" href="../surrogate/">Surrogates</a></li><li><a class="tocitem" href="../optimizations/">Optimization</a></li></ul></li><li><span class="tocitem">Benchmarks</span><ul><li><a class="tocitem" href="../sphere_function/">Sphere function</a></li><li><a class="tocitem" href="../lp/">Lp norm</a></li><li><a class="tocitem" href="../rosenbrock/">Rosenbrock</a></li><li><a class="tocitem" href="../tensor_prod/">Tensor product</a></li><li><a class="tocitem" href="../cantilever/">Cantilever beam</a></li><li><a class="tocitem" href="../water_flow/">Water Flow function</a></li><li><a class="tocitem" href="../welded_beam/">Welded beam function</a></li><li><a class="tocitem" href="../BraninFunction/">Branin function</a></li><li><a class="tocitem" href="../ImprovedBraninFunction/">Improved Branin function</a></li><li><a class="tocitem" href="../ackley/">Ackley function</a></li><li><a class="tocitem" href="../gramacylee/">Gramacy &amp; Lee Function</a></li><li><a class="tocitem" href="../Salustowicz/">Salustowicz Benchmark</a></li><li><a class="tocitem" href="../multi_objective_opt/">Multi objective optimization</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Gaussian Process</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Gaussian Process</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Surrogates.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Surrogates.jl/blob/master/docs/src/abstractgps.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Gaussian-Process-Surrogate-Tutorial"><a class="docs-heading-anchor" href="#Gaussian-Process-Surrogate-Tutorial">Gaussian Process Surrogate Tutorial</a><a id="Gaussian-Process-Surrogate-Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#Gaussian-Process-Surrogate-Tutorial" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This surrogate requires the &#39;SurrogatesAbstractGPs&#39; module, which can be added by inputting &quot;]add SurrogatesAbstractGPs&quot; from the Julia command line. </p></div></div><p>Gaussian Process regression in Surrogates.jl is implemented as a simple wrapper around the <a href="https://github.com/JuliaGaussianProcesses/AbstractGPs.jl">AbstractGPs.jl</a> package. AbstractGPs comes with a variety of covariance functions (kernels). See <a href="https://github.com/JuliaGaussianProcesses/KernelFunctions.jl/">KernelFunctions.jl</a> for examples.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>The examples below demonstrate the use of AbstractGPs with out-of-the-box settings without hyperparameter optimization (i.e. without changing parameters like lengthscale, signal variance, and noise variance). Beyond hyperparameter optimization, careful initialization of hyperparameters and priors on the parameters is required for this surrogate to work properly. For more details on how to fit GPs in practice, check out <a href="https://infallible-thompson-49de36.netlify.app/">A Practical Guide to Gaussian Processes</a>.</p><p>Also see this <a href="https://juliagaussianprocesses.github.io/AbstractGPs.jl/stable/examples/1-mauna-loa/#Hyperparameter-Optimization">example</a> to understand hyperparameter optimization with AbstractGPs.</p></div></div><h2 id="1D-Example"><a class="docs-heading-anchor" href="#1D-Example">1D Example</a><a id="1D-Example-1"></a><a class="docs-heading-anchor-permalink" href="#1D-Example" title="Permalink"></a></h2><p>In the example below, the &#39;gp_surrogate&#39; assignment code can be commented / uncommented to see how the different kernels influence the predictions. </p><pre><code class="language-julia hljs">using Surrogates
using Plots
default()
using AbstractGPs #required to access different types of kernels
using SurrogatesAbstractGPs

f(x) = (6 * x - 2)^2 * sin(12 * x - 4)
n_samples = 4
lower_bound = 0.0
upper_bound = 1.0
xs = lower_bound:0.001:upper_bound
x = sample(n_samples, lower_bound, upper_bound, SobolSample())
y = f.(x)
#gp_surrogate = AbstractGPSurrogate(x,y, gp=GP(SqExponentialKernel()), Σy=0.05) #example of Squared Exponential Kernel
#gp_surrogate = AbstractGPSurrogate(x,y, gp=GP(MaternKernel()), Σy=0.05) #example of MaternKernel
gp_surrogate = AbstractGPSurrogate(x,y, gp=GP(PolynomialKernel(; c=2.0, degree=5)), Σy=0.25)
plot(x, y, seriestype=:scatter, label=&quot;Sampled points&quot;, xlims=(lower_bound, upper_bound), ylims=(-7, 17), legend=:top)
plot!(xs, f.(xs), label=&quot;True function&quot;, legend=:top)
plot!(0:0.001:1, gp_surrogate.gp_posterior; label=&quot;Posterior&quot;, ribbon_scale=2)</code></pre><img src="d95f37b4.svg" alt="Example block output"/><h2 id="Optimization-Example"><a class="docs-heading-anchor" href="#Optimization-Example">Optimization Example</a><a id="Optimization-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-Example" title="Permalink"></a></h2><p>This example shows the use of AbstractGP Surrogates to find the minima of a function:</p><pre><code class="language-julia hljs">using Surrogates
using Plots
using AbstractGPs
using SurrogatesAbstractGPs

f(x) = (x-2)^2
n_samples = 4
lower_bound = 0.0
upper_bound = 4.0
xs = lower_bound:0.1:upper_bound
x = sample(n_samples, lower_bound, upper_bound, SobolSample())
y = f.(x)
gp_surrogate = AbstractGPSurrogate(x,y)
@show surrogate_optimize(f, SRBF(), lower_bound, upper_bound, gp_surrogate, SobolSample())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(2.0012499999999998, 1.5624999999993784e-6)</code></pre><p>Plotting the function and the sampled points: </p><pre><code class="language-julia hljs">scatter(gp_surrogate.x, gp_surrogate.y, label=&quot;Sampled points&quot;, ylims=(-1.0, 5.0), legend=:top)
plot!(xs, gp_surrogate.(xs), label=&quot;Surrogate function&quot;, ribbon=p-&gt;std_error_at_point(gp_surrogate, p), legend=:top)
plot!(xs, f.(xs), label=&quot;True function&quot;, legend=:top)</code></pre><img src="d0150ab9.svg" alt="Example block output"/><h2 id="ND-Example"><a class="docs-heading-anchor" href="#ND-Example">ND Example</a><a id="ND-Example-1"></a><a class="docs-heading-anchor-permalink" href="#ND-Example" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Plots
default(c=:matter, legend=false, xlabel=&quot;x&quot;, ylabel=&quot;y&quot;)
using Surrogates
using AbstractGPs
using SurrogatesAbstractGPs


hypot_func = z -&gt; 3*hypot(z...)+1
n_samples = 50
lower_bound = [-1.0, -1.0]
upper_bound = [1.0, 1.0]

xys = sample(n_samples, lower_bound, upper_bound, SobolSample())
zs = hypot_func.(xys);

x, y = -2:2, -2:2
p1 = surface(x, y, (x1,x2) -&gt; hypot_func((x1,x2)))
xs = [xy[1] for xy in xys]
ys = [xy[2] for xy in xys]
scatter!(xs, ys, zs)
p2 = contour(x, y, (x1,x2) -&gt; hypot_func((x1,x2)))
scatter!(xs, ys)
plot(p1, p2, title=&quot;True function&quot;)</code></pre><img src="17d97ad9.svg" alt="Example block output"/><p>Now let&#39;s see how our surrogate performs:</p><pre><code class="language-julia hljs">gp_surrogate = AbstractGPSurrogate(xys, zs)
p1 = surface(x, y, (x, y) -&gt; gp_surrogate([x y]))
scatter!(xs, ys, zs, marker_z=zs)
p2 = contour(x, y, (x, y) -&gt; gp_surrogate([x y]))
scatter!(xs, ys, marker_z=zs)
plot(p1, p2, title=&quot;Surrogate&quot;)</code></pre><img src="3b470e77.svg" alt="Example block output"/><pre><code class="language-julia hljs">@show gp_surrogate((0.2,0.2))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.9682380785540028</code></pre><pre><code class="language-julia hljs">@show hypot_func((0.2,0.2))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.8485281374238571</code></pre><p>And this is our log marginal posterior predictive probability:</p><pre><code class="language-julia hljs">@show logpdf_surrogate(gp_surrogate)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">64.91417186860565</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../kriging/">« Kriging</a><a class="docs-footer-nextpage" href="../lobachevsky/">Lobachevsky »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 19 January 2024 07:38">Friday 19 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
