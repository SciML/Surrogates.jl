<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>InverseDistance · Surrogates.jl</title><meta name="title" content="InverseDistance · Surrogates.jl"/><meta property="og:title" content="InverseDistance · Surrogates.jl"/><meta property="twitter:title" content="InverseDistance · Surrogates.jl"/><meta name="description" content="Documentation for Surrogates.jl."/><meta property="og:description" content="Documentation for Surrogates.jl."/><meta property="twitter:description" content="Documentation for Surrogates.jl."/><meta property="og:url" content="https://docs.sciml.ai/Surrogates/stable/InverseDistance/"/><meta property="twitter:url" content="https://docs.sciml.ai/Surrogates/stable/InverseDistance/"/><link rel="canonical" href="https://docs.sciml.ai/Surrogates/stable/InverseDistance/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Surrogates.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Surrogates.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Surrogates.jl: Surrogate models and optimization for scientific machine learning</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/">Basics</a></li><li><a class="tocitem" href="../radials/">Radials</a></li><li><a class="tocitem" href="../kriging/">Kriging</a></li><li><a class="tocitem" href="../abstractgps/">Gaussian Process</a></li><li><a class="tocitem" href="../lobachevsky/">Lobachevsky</a></li><li><a class="tocitem" href="../LinearSurrogate/">Linear</a></li><li class="is-active"><a class="tocitem" href>InverseDistance</a><ul class="internal"><li><a class="tocitem" href="#Building-a-Surrogate"><span>Building a Surrogate</span></a></li><li><a class="tocitem" href="#Optimizing"><span>Optimizing</span></a></li><li><a class="tocitem" href="#Inverse-Distance-Surrogate-Tutorial-(ND):"><span>Inverse Distance Surrogate Tutorial (ND):</span></a></li></ul></li><li><a class="tocitem" href="../randomforest/">RandomForest</a></li><li><a class="tocitem" href="../secondorderpoly/">SecondOrderPolynomial</a></li><li><a class="tocitem" href="../neural/">NeuralSurrogate</a></li><li><a class="tocitem" href="../wendland/">Wendland</a></li><li><a class="tocitem" href="../polychaos/">Polynomial Chaos</a></li><li><a class="tocitem" href="../variablefidelity/">Variable Fidelity</a></li><li><a class="tocitem" href="../gek/">Gradient Enhanced Kriging</a></li><li><a class="tocitem" href="../gekpls/">GEKPLS</a></li><li><a class="tocitem" href="../moe/">MOE</a></li><li><a class="tocitem" href="../parallel/">Parallel Optimization</a></li></ul></li><li><span class="tocitem">User guide</span><ul><li><a class="tocitem" href="../samples/">Samples</a></li><li><a class="tocitem" href="../surrogate/">Surrogates</a></li><li><a class="tocitem" href="../optimizations/">Optimization</a></li></ul></li><li><span class="tocitem">Benchmarks</span><ul><li><a class="tocitem" href="../sphere_function/">Sphere function</a></li><li><a class="tocitem" href="../lp/">Lp norm</a></li><li><a class="tocitem" href="../rosenbrock/">Rosenbrock</a></li><li><a class="tocitem" href="../tensor_prod/">Tensor product</a></li><li><a class="tocitem" href="../cantilever/">Cantilever beam</a></li><li><a class="tocitem" href="../water_flow/">Water Flow function</a></li><li><a class="tocitem" href="../welded_beam/">Welded beam function</a></li><li><a class="tocitem" href="../BraninFunction/">Branin function</a></li><li><a class="tocitem" href="../ImprovedBraninFunction/">Improved Branin function</a></li><li><a class="tocitem" href="../ackley/">Ackley function</a></li><li><a class="tocitem" href="../gramacylee/">Gramacy &amp; Lee Function</a></li><li><a class="tocitem" href="../Salustowicz/">Salustowicz Benchmark</a></li><li><a class="tocitem" href="../multi_objective_opt/">Multi objective optimization</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>InverseDistance</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>InverseDistance</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Surrogates.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Surrogates.jl/blob/master/docs/src/InverseDistance.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="InverseDistance-Surrogate-Tutorial"><a class="docs-heading-anchor" href="#InverseDistance-Surrogate-Tutorial">InverseDistance Surrogate Tutorial</a><a id="InverseDistance-Surrogate-Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#InverseDistance-Surrogate-Tutorial" title="Permalink"></a></h1><p>The <strong>Inverse Distance Surrogate</strong> is an interpolating method, and in this method, the unknown points are calculated with a weighted average of the sampling points. This model uses the inverse distance between the unknown and training points to predict the unknown point. We do not need to fit this model because the response of an unknown point x is computed with respect to the distance between x and the training points.</p><p>Let&#39;s optimize the following function to use Inverse Distance Surrogate:</p><p class="math-container">\[f(x) = sin(x) + sin(x)^2 + sin(x)^3\]</p><p>.</p><p>First of all, we have to import these two packages: <code>Surrogates</code> and <code>Plots</code>.</p><pre><code class="language-julia hljs">using Surrogates
using Plots</code></pre><h3 id="Sampling"><a class="docs-heading-anchor" href="#Sampling">Sampling</a><a id="Sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling" title="Permalink"></a></h3><p>We choose to sample f in 1000 points between 0 and 10 using the <code>sample</code> function. The sampling points are chosen using a Low Discrepancy, this can be done by passing <code>HaltonSample()</code> to the <code>sample</code> function.</p><pre><code class="language-julia hljs">f(x) = sin(x) + sin(x)^2 + sin(x)^3

n_samples = 100
lower_bound = 0.0
upper_bound = 10.0
x = sample(n_samples, lower_bound, upper_bound, HaltonSample())
y = f.(x)

scatter(x, y, label = &quot;Sampled points&quot;, xlims = (lower_bound, upper_bound), legend = :top)
plot!(f, label = &quot;True function&quot;, xlims = (lower_bound, upper_bound), legend = :top)</code></pre><img src="7e77cefe.svg" alt="Example block output"/><h2 id="Building-a-Surrogate"><a class="docs-heading-anchor" href="#Building-a-Surrogate">Building a Surrogate</a><a id="Building-a-Surrogate-1"></a><a class="docs-heading-anchor-permalink" href="#Building-a-Surrogate" title="Permalink"></a></h2><pre><code class="language-julia hljs">InverseDistance = InverseDistanceSurrogate(x, y, lower_bound, upper_bound)
prediction = InverseDistance(5.0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-0.310175502145857</code></pre><p>Now, we will simply plot <code>InverseDistance</code>:</p><pre><code class="language-julia hljs">plot(x, y, seriestype = :scatter, label = &quot;Sampled points&quot;,
    xlims = (lower_bound, upper_bound), legend = :top)
plot!(f, label = &quot;True function&quot;, xlims = (lower_bound, upper_bound), legend = :top)
plot!(InverseDistance, label = &quot;Surrogate function&quot;,
    xlims = (lower_bound, upper_bound), legend = :top)</code></pre><img src="b73916b3.svg" alt="Example block output"/><h2 id="Optimizing"><a class="docs-heading-anchor" href="#Optimizing">Optimizing</a><a id="Optimizing-1"></a><a class="docs-heading-anchor-permalink" href="#Optimizing" title="Permalink"></a></h2><p>Having built a surrogate, we can now use it to search for minima in our original function <code>f</code>.</p><p>To optimize using our surrogate we call <code>surrogate_optimize</code> method. We choose to use Stochastic RBF as the optimization technique and again Sobol sampling as the sampling technique.</p><pre><code class="language-julia hljs">surrogate_optimize(
    f, SRBF(), lower_bound, upper_bound, InverseDistance, SobolSample())
scatter(x, y, label = &quot;Sampled points&quot;, legend = :top)
plot!(f, label = &quot;True function&quot;, xlims = (lower_bound, upper_bound), legend = :top)
plot!(InverseDistance, label = &quot;Surrogate function&quot;,
    xlims = (lower_bound, upper_bound), legend = :top)</code></pre><img src="e998e5a6.svg" alt="Example block output"/><h2 id="Inverse-Distance-Surrogate-Tutorial-(ND):"><a class="docs-heading-anchor" href="#Inverse-Distance-Surrogate-Tutorial-(ND):">Inverse Distance Surrogate Tutorial (ND):</a><a id="Inverse-Distance-Surrogate-Tutorial-(ND):-1"></a><a class="docs-heading-anchor-permalink" href="#Inverse-Distance-Surrogate-Tutorial-(ND):" title="Permalink"></a></h2><p>First of all we will define the <code>Schaffer</code> function we are going to build a surrogate for. Notice, how its argument is a vector of numbers, one for each coordinate, and its output is a scalar.</p><pre><code class="language-julia hljs">using Plots
default(c = :matter, legend = false, xlabel = &quot;x&quot;, ylabel = &quot;y&quot;)
using Surrogates

function schaffer(x)
    x1 = x[1]
    x2 = x[2]
    fact1 = (sin(x1^2 - x2^2))^2 - 0.5
    fact2 = (1 + 0.001 * (x1^2 + x2^2))^2
    y = 0.5 + fact1 / fact2
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">schaffer (generic function with 1 method)</code></pre><h3 id="Sampling-2"><a class="docs-heading-anchor" href="#Sampling-2">Sampling</a><a class="docs-heading-anchor-permalink" href="#Sampling-2" title="Permalink"></a></h3><p>Let&#39;s define our bounds, this time we are working in two dimensions. In particular we want our first dimension <code>x</code> to have bounds <code>-5, 10</code>, and <code>0, 15</code> for the second dimension. We are taking 100 samples of the space using Sobol Sequences. We then evaluate our function on all the sampling points.</p><pre><code class="language-julia hljs">n_samples = 100
lower_bound = [-5.0, 0.0]
upper_bound = [10.0, 15.0]

xys = sample(n_samples, lower_bound, upper_bound, SobolSample())
zs = schaffer.(xys);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100-element Vector{Float64}:
 0.9466537351915296
 0.43907983917415927
 0.6244015434660956
 0.24029684484911762
 0.5445245406780457
 0.49603219937739446
 0.48167742985632134
 0.8026235934086707
 0.132320236918473
 0.12042018982244562
 ⋮
 0.8911120978015648
 0.3394437875244999
 0.36452094199290475
 0.6551197870142627
 0.6837172632966668
 0.09287469403688647
 0.7340338272751679
 0.06640336807634234
 0.6345377899252921</code></pre><pre><code class="language-julia hljs">x, y = -5:10, 0:15
p1 = surface(x, y, (x1, x2) -&gt; schaffer((x1, x2)))
xs = [xy[1] for xy in xys]
ys = [xy[2] for xy in xys]
scatter!(xs, ys, zs)
p2 = contour(x, y, (x1, x2) -&gt; schaffer((x1, x2)))
scatter!(xs, ys)
plot(p1, p2, title = &quot;True function&quot;)</code></pre><img src="cdd99002.svg" alt="Example block output"/><h3 id="Building-a-surrogate"><a class="docs-heading-anchor" href="#Building-a-surrogate">Building a surrogate</a><a id="Building-a-surrogate-1"></a><a class="docs-heading-anchor-permalink" href="#Building-a-surrogate" title="Permalink"></a></h3><p>Using the sampled points we build the surrogate, the steps are analogous to the 1-dimensional case.</p><pre><code class="language-julia hljs">InverseDistance = InverseDistanceSurrogate(xys, zs, lower_bound, upper_bound)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(::InverseDistanceSurrogate{Vector{Tuple{Float64, Float64}}, Vector{Float64}, Vector{Float64}, Vector{Float64}, Float64}) (generic function with 1 method)</code></pre><pre><code class="language-julia hljs">p1 = surface(x, y, (x, y) -&gt; InverseDistance([x y]))
scatter!(xs, ys, zs, marker_z = zs)
p2 = contour(x, y, (x, y) -&gt; InverseDistance([x y]))
scatter!(xs, ys, marker_z = zs)
plot(p1, p2, title = &quot;Surrogate&quot;)</code></pre><img src="c708b9e2.svg" alt="Example block output"/><h3 id="Optimizing-2"><a class="docs-heading-anchor" href="#Optimizing-2">Optimizing</a><a class="docs-heading-anchor-permalink" href="#Optimizing-2" title="Permalink"></a></h3><p>With our surrogate, we can now search for the minima of the function.</p><p>Notice how the new sampled points, which were created during the optimization process, are appended to the <code>xys</code> array. This is why its size changes.</p><pre><code class="language-julia hljs">size(xys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(100,)</code></pre><pre><code class="language-julia hljs">surrogate_optimize(schaffer, SRBF(), lower_bound, upper_bound,
    InverseDistance, SobolSample(), maxiters = 10)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">((3.7574738334769493, 1.2574738334769493), 0.01615276737174909)</code></pre><pre><code class="language-julia hljs">size(xys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(176,)</code></pre><pre><code class="language-julia hljs">p1 = surface(x, y, (x, y) -&gt; InverseDistance([x y]))
xs = [xy[1] for xy in xys]
ys = [xy[2] for xy in xys]
zs = schaffer.(xys)
scatter!(xs, ys, zs, marker_z = zs)
p2 = contour(x, y, (x, y) -&gt; InverseDistance([x y]))
scatter!(xs, ys, marker_z = zs)
plot(p1, p2)</code></pre><img src="06720fd0.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../LinearSurrogate/">« Linear</a><a class="docs-footer-nextpage" href="../randomforest/">RandomForest »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Saturday 8 March 2025 13:23">Saturday 8 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
